<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç”Ÿç”¢æ—¥å ±è¡¨ ä¿®æ”¹ç”³è«‹</title>
  <style>

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'æ–°ç´°æ˜é«”', 'Microsoft JhengHei', Arial, sans-serif;
      padding: 20px;
      background: #fff;
      width: 100%;
    }

    .print-container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      background: #fff;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 12px;
      table-layout: fixed;  /* å›ºå®šè¡¨æ ¼ä½ˆå±€ï¼Œç¢ºä¿æ¬„å¯¬ä¸€è‡´ */
    }

    th, td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
      font-size: 14px;
      white-space: nowrap; /* é¿å…å…§å®¹æ›è¡ŒæŠŠé«˜åº¦æ’å¤§ */
    }

    .title-row {
      font-size: 32px;
      font-weight: bold;
      padding: 18px;
      text-align: center;
      white-space: nowrap;
    }

    .header-cell { background-color: #f0f0f0; font-weight: bold; }
    .label-cell  { background-color: #e8e8e8; font-weight: bold; width: 25%; }
    .value-cell  { text-align: center; width: 25%; }
    .empty-column { width: 50%; background-color: #fafafa; }

    /* è£œé½Šé«˜åº¦çš„ç©ºç™½åˆ—ï¼šç”¨ä¾†æŠŠç°½æ ¸æ¨åˆ°æœ€åº•ï¼ˆåˆ—å°æ™‚æœƒåƒæ‰å‰©é¤˜é«˜åº¦ï¼‰ */
    .fill-row td {
      height: 30px;   /* è¢å¹•é è¦½ç”¨ */
      padding: 0;
      background: #fff;
      border-bottom: none; /* ç§»é™¤ã€Œç”Ÿç®¡ã€ä¸Šæ–¹æœ€æ¥è¿‘é‚£æ¢æ©«ç·šï¼ˆfill-row èˆ‡ sign-row äº¤ç•Œï¼‰ */
      border-left: none;   /* ç§»é™¤å·¦å´çŸ­ç›´ç·šï¼ˆç°½æ ¸å€å´é‚Šï¼‰ */
      border-right: none;  /* ç§»é™¤å³å´çŸ­ç›´ç·šï¼ˆç°½æ ¸å€å´é‚Šï¼‰ */
    }

    /* ç°½æ ¸åˆ—ï¼šå›ºå®šåœ¨è¡¨æ ¼å³ä¸‹ */
    .sign-row td {
      text-align: right;
      vertical-align: bottom;
      font-size: 18px;
      font-weight: bold;
      padding-right: 12px;
      padding-bottom: 10px;
      background: #fff;
      border-top: none; /* èˆ‡ fill-row æ­é…ï¼Œç¢ºä¿äº¤ç•Œè™•ä¸å‡ºç¾æ©«ç·š */
      border-bottom: none; /* ç§»é™¤ã€Œç”Ÿç®¡ã€ä¸‹æ–¹æœ€æ¥è¿‘é‚£æ¢æ©«ç·š */
      border-left: none;   /* ç§»é™¤ç°½æ ¸å€æœ€å·¦é‚Šç›´ç·š */
      border-right: none;  /* ç§»é™¤ç°½æ ¸å€æœ€å³é‚Šç›´ç·š */
    }

    .sign-line{
      display: inline-block;
      width: 45mm;
      border-bottom: 1px solid #000;
      height: 0.9em;
      vertical-align: baseline;
      margin-left: 6px;
    }

    @media print {
      @page {
        size: A4 landscape; /* æ©«å¼åˆ—å° */
        margin: 4mm 5mm 4mm 5mm; /* ä¸Š å³ ä¸‹ å·¦ */
      }

      html, body {
        margin: 0 !important;
        padding: 0 !important;
        background: #fff !important;
      }

      .no-print { display: none !important; }

      /* æ¯å€‹è¡¨æ ¼å®¹å™¨ä½”ä¸€é  */
      .print-container {
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 0 !important;
        height: 200mm !important;
        overflow: hidden !important;
        page-break-after: always !important;  /* æ¯å€‹è¡¨æ ¼å¾Œåˆ†é  */
        break-after: page !important;
      }

      /* æœ€å¾Œä¸€å€‹è¡¨æ ¼ä¸åˆ†é  */
      .print-container:last-child {
        page-break-after: avoid !important;
        break-after: avoid-page !important;
      }

      table {
        height: 100% !important;
        margin: 0 !important;
        page-break-inside: avoid !important;
        break-inside: avoid !important;
      }

      /* è®“ fill-row åƒæ‰å‰©é¤˜é«˜åº¦ï¼ŒæŠŠç°½æ ¸æ¨åˆ°æœ€åº• */
            .fill-row td { height: 100% !important; border-left: none !important; border-right: none !important; border-bottom: none !important; }

      /* ç°½æ ¸ç›¡é‡é å³ä¸‹ */
      .sign-row td {
        padding-right: 2mm !important;
        padding-bottom: 2mm !important;
        border-top: none !important;
        border-bottom: none !important;
        border-left: none !important;
        border-right: none !important;
      }
    }

    .print-button {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 24px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      z-index: 1000;
    }

    .print-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
    }

  </style>
</head>
<body>
  <button class="print-button no-print" onclick="window.print()">ğŸ–¨ï¸ åˆ—å°æ­¤é </button>

  {% for page_idx in range(0, records|length, 2) %}
  <div class="print-container">
    <table>
      <!-- æ¨™é¡Œåˆ— -->
      <tr>
        <td colspan="6" class="title-row">ç”Ÿç”¢æ—¥å ±è¡¨ ä¿®æ”¹ç”³è«‹</td>
      </tr>

      {% set left_record = records[page_idx] if page_idx < records|length else {} %}
      {% set right_record = records[page_idx + 1] if page_idx + 1 < records|length else {} %}

      <!-- ç”Ÿç”¢æ—¥å ±è¡¨åºè™Ÿ -->
      <tr>
        <td class="label-cell">â˜…ç”Ÿç”¢æ—¥å ±è¡¨åºè™Ÿ</td>
        <td colspan="2" class="value-cell">{{ left_record.dy_serial_num or '' }}</td>
        <td class="label-cell">â˜…ç”Ÿç”¢æ—¥å ±è¡¨åºè™Ÿ</td>
        <td colspan="2" class="value-cell">{{ right_record.dy_serial_num or '' }}</td>
      </tr>

      <!-- ç™¼å·¥å–®è™Ÿ -->
      <tr>
        <td class="label-cell">ç™¼å·¥å–®è™Ÿ</td>
        <td colspan="2" class="value-cell">{{ left_record.pd_num or '' }}</td>
        <td class="label-cell">ç™¼å·¥å–®è™Ÿ</td>
        <td colspan="2" class="value-cell">{{ right_record.pd_num or '' }}</td>
      </tr>

      <!-- åˆªé™¤æ¨™è¨˜ -->
      <tr>
        <td class="label-cell">ç”Ÿç”¢æ—¥å ±è¡¨åˆªé™¤</td>
        <td class="value-cell"></td>
        <td class="value-cell">{% if left_record.delete_flag == 'æ˜¯' %}Y{% elif left_record.delete_flag == 'å¦' %}N{% endif %}</td>
        <td class="label-cell">ç”Ÿç”¢æ—¥å ±è¡¨åˆªé™¤</td>
        <td class="value-cell"></td>
        <td class="value-cell">{% if right_record.delete_flag == 'æ˜¯' %}Y{% elif right_record.delete_flag == 'å¦' %}N{% endif %}</td>
      </tr>

      <!-- åŸæœ¬/ä¿®æ”¹ç‚ºæ¨™é¡Œ -->
      <tr>
        <td class="label-cell"></td>
        <td class="header-cell">åŸæœ¬</td>
        <td class="header-cell">ä¿®æ”¹ç‚º</td>
        <td class="label-cell"></td>
        <td class="header-cell">åŸæœ¬</td>
        <td class="header-cell">ä¿®æ”¹ç‚º</td>
      </tr>

      <!-- å·¥ä½œæ—¥æœŸ -->
      <tr>
        <td class="label-cell">å·¥ä½œæ—¥æœŸ</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.work_date_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.work_date_modified or '' }}</td>
        <td class="label-cell">å·¥ä½œæ—¥æœŸ</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.work_date_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.work_date_modified or '' }}</td>
      </tr>

      <!-- å·¥ä½œè€…ç·¨è™Ÿ -->
      <tr>
        <td class="label-cell">å·¥ä½œè€…ç·¨è™Ÿ</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.worker_num_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.worker_num_modified or '' }}</td>
        <td class="label-cell">å·¥ä½œè€…ç·¨è™Ÿ</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.worker_num_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.worker_num_modified or '' }}</td>
      </tr>

      <!-- æ©Ÿå°ä»£è™Ÿ -->
      <tr>
        <td class="label-cell">æ©Ÿå°ä»£è™Ÿ</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.machine_num_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.machine_num_modified or '' }}</td>
        <td class="label-cell">æ©Ÿå°ä»£è™Ÿ</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.machine_num_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.machine_num_modified or '' }}</td>
      </tr>

      <!-- å·¥åºç·¨è™Ÿ -->
      <tr>
        <td class="label-cell">å·¥åºç·¨è™Ÿ</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.prod_num_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.prod_num_modified or '' }}</td>
        <td class="label-cell">å·¥åºç·¨è™Ÿ</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.prod_num_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.prod_num_modified or '' }}</td>
      </tr>

      <!-- å®Œå·¥æ•¸ -->
      <tr>
        <td class="label-cell">å®Œå·¥æ•¸</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.finish_qty_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.finish_qty_modified or '' }}</td>
        <td class="label-cell">å®Œå·¥æ•¸</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.finish_qty_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.finish_qty_modified or '' }}</td>
      </tr>

      <!-- ä¸è‰¯æ•¸ -->
      <tr>
        <td class="label-cell">ä¸è‰¯æ•¸</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.bad_qty_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.bad_qty_modified or '' }}</td>
        <td class="label-cell">ä¸è‰¯æ•¸</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.bad_qty_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.bad_qty_modified or '' }}</td>
      </tr>

      <!-- èµ·å·¥æ™‚é–“ -->
      <tr>
        <td class="label-cell">èµ·å·¥æ™‚é–“</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.start_time_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.start_time_modified or '' }}</td>
        <td class="label-cell">èµ·å·¥æ™‚é–“</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.start_time_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.start_time_modified or '' }}</td>
      </tr>

      <!-- å®Œå·¥æ™‚é–“ -->
      <tr>
        <td class="label-cell">å®Œå·¥æ™‚é–“</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.finish_time_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.finish_time_modified or '' }}</td>
        <td class="label-cell">å®Œå·¥æ™‚é–“</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.finish_time_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.finish_time_modified or '' }}</td>
      </tr>

      <!-- é™¤å¤–åç¨±1 -->
      <tr>
        <td class="label-cell">é™¤å¤–åç¨±1</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.extra_name1_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.extra_name1_modified or '' }}</td>
        <td class="label-cell">é™¤å¤–åç¨±1</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.extra_name1_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.extra_name1_modified or '' }}</td>
      </tr>

      <!-- é™¤å¤–æ™‚é–“1 -->
      <tr>
        <td class="label-cell">é™¤å¤–æ™‚é–“1</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.extra_time1_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.extra_time1_modified or '' }}</td>
        <td class="label-cell">é™¤å¤–æ™‚é–“1</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.extra_time1_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.extra_time1_modified or '' }}</td>
      </tr>

      <!-- é™¤å¤–åç¨±2 -->
      <tr>
        <td class="label-cell">é™¤å¤–åç¨±2</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.extra_name2_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.extra_name2_modified or '' }}</td>
        <td class="label-cell">é™¤å¤–åç¨±2</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.extra_name2_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.extra_name2_modified or '' }}</td>
      </tr>

      <!-- é™¤å¤–æ™‚é–“2 -->
      <tr>
        <td class="label-cell">é™¤å¤–æ™‚é–“2</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.extra_time2_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.extra_time2_modified or '' }}</td>
        <td class="label-cell">é™¤å¤–æ™‚é–“2</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.extra_time2_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.extra_time2_modified or '' }}</td>
      </tr>

      <!-- é™¤å¤–åç¨±3 -->
      <tr>
        <td class="label-cell">é™¤å¤–åç¨±3</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.extra_name3_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.extra_name3_modified or '' }}</td>
        <td class="label-cell">é™¤å¤–åç¨±3</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.extra_name3_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.extra_name3_modified or '' }}</td>
      </tr>

      <!-- é™¤å¤–æ™‚é–“3 -->
      <tr>
        <td class="label-cell">é™¤å¤–æ™‚é–“3</td>
        <td class="value-cell">{% if left_record.delete_flag != 'æ˜¯' %}{{ left_record.extra_time3_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ left_record.extra_time3_modified or '' }}</td>
        <td class="label-cell">é™¤å¤–æ™‚é–“3</td>
        <td class="value-cell">{% if right_record.delete_flag != 'æ˜¯' %}{{ right_record.extra_time3_original or '' }}{% endif %}</td>
        <td class="value-cell">{{ right_record.extra_time3_modified or '' }}</td>
      </tr>

      <!-- æ’æ»¿å‰©é¤˜é«˜åº¦ï¼šæŠŠç°½æ ¸æ¨åˆ°æœ€åº• -->
      <tr class="fill-row">
        <td colspan="6"></td>
      </tr>

      <!-- ç°½æ ¸ï¼ˆè¡¨æ ¼å³ä¸‹ï¼‰ -->
      <tr class="sign-row">
        <td colspan="6">ç”Ÿç®¡ï¼š<span class="sign-line"></span></td>
      </tr>
    </table>
  </div>
  {% endfor %}

  <script>
    // é é¢è¼‰å…¥å¾Œè‡ªå‹•æº–å‚™åˆ—å°
    window.addEventListener('load', function() {
      setTimeout(function() {
        // å¯é¸ï¼šè‡ªå‹•é–‹å•Ÿåˆ—å°å°è©±æ¡†
        // window.print();
      }, 500);
    });
  </script>
</body>
</html>
